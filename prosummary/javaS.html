<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>后端项目总结 | 慢下来~享受当下~</title>
    <meta name="generator" content="VuePress 1.9.8">
    <link rel="icon" href="/assets/img/favicon.ico">
    <meta name="description" content="">
    <meta name="keywords" content="网站关键词">
    <meta name="author" content="zch1337">
    
    <link rel="preload" href="/assets/css/0.styles.7b36eabc.css" as="style"><link rel="preload" href="/assets/js/app.dd397728.js" as="script"><link rel="preload" href="/assets/js/2.6430ac10.js" as="script"><link rel="preload" href="/assets/js/26.079d4c49.js" as="script"><link rel="prefetch" href="/assets/js/10.de11ce4e.js"><link rel="prefetch" href="/assets/js/11.eb24f3d9.js"><link rel="prefetch" href="/assets/js/12.58efe507.js"><link rel="prefetch" href="/assets/js/13.3d3cb395.js"><link rel="prefetch" href="/assets/js/14.163292db.js"><link rel="prefetch" href="/assets/js/15.0eeb79e2.js"><link rel="prefetch" href="/assets/js/16.0fd3ccda.js"><link rel="prefetch" href="/assets/js/17.a13c3e02.js"><link rel="prefetch" href="/assets/js/18.e19d705d.js"><link rel="prefetch" href="/assets/js/19.52c11801.js"><link rel="prefetch" href="/assets/js/20.4cfdf5ad.js"><link rel="prefetch" href="/assets/js/21.b6ab34b9.js"><link rel="prefetch" href="/assets/js/22.d6b62e7e.js"><link rel="prefetch" href="/assets/js/23.5bfd3dd2.js"><link rel="prefetch" href="/assets/js/24.8f60b85b.js"><link rel="prefetch" href="/assets/js/25.23e92ce8.js"><link rel="prefetch" href="/assets/js/27.2a42a3bc.js"><link rel="prefetch" href="/assets/js/28.96e30dd4.js"><link rel="prefetch" href="/assets/js/29.92dc21e8.js"><link rel="prefetch" href="/assets/js/3.7ceae309.js"><link rel="prefetch" href="/assets/js/30.a44ddd87.js"><link rel="prefetch" href="/assets/js/31.ebffffad.js"><link rel="prefetch" href="/assets/js/32.cbeff704.js"><link rel="prefetch" href="/assets/js/33.f34223b0.js"><link rel="prefetch" href="/assets/js/4.3357b40a.js"><link rel="prefetch" href="/assets/js/5.1d0c2d3a.js"><link rel="prefetch" href="/assets/js/6.aeb7dc84.js"><link rel="prefetch" href="/assets/js/7.f2b24add.js"><link rel="prefetch" href="/assets/js/8.b624c3e8.js"><link rel="prefetch" href="/assets/js/9.4891ca45.js">
    <link rel="stylesheet" href="/assets/css/0.styles.7b36eabc.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/assets/img/hero.png" alt="慢下来~享受当下~" class="logo"> <span class="site-name can-hide">慢下来~享受当下~</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="英语" class="dropdown-title"><span class="title">英语</span> <span class="arrow down"></span></button> <button type="button" aria-label="英语" class="mobile-dropdown-title"><span class="title">英语</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/yingyu/fangfa.html" class="nav-link">
  方法
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端" class="mobile-dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/yunwei/sanjianke.html" class="nav-link">
  三剑客
</a></li><li class="dropdown-item"><!----> <a href="/yunwei/vue.html" class="nav-link">
  vue全家桶
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><span class="title">后端</span> <span class="arrow down"></span></button> <button type="button" aria-label="后端" class="mobile-dropdown-title"><span class="title">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          第一阶段-基础
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/houduan/javase.html" class="nav-link">
  javase
</a></li><li class="dropdown-subitem"><a href="/houduan/mysql.html" class="nav-link">
  mysql
</a></li><li class="dropdown-subitem"><a href="/houduan/jdbc.html" class="nav-link">
  jdbc
</a></li><li class="dropdown-subitem"><a href="/houduan/servlet.html" class="nav-link">
  servlet
</a></li></ul></li><li class="dropdown-item"><h4>
          第二阶段-框架
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/houduan/maven.html" class="nav-link">
  maven
</a></li><li class="dropdown-subitem"><a href="/houduan/spring.html" class="nav-link">
  spring
</a></li><li class="dropdown-subitem"><a href="/houduan/springMVC.html" class="nav-link">
  springMVC
</a></li><li class="dropdown-subitem"><a href="/houduan/mybatis+PLUS.html" class="nav-link">
  mybatis+PLUS
</a></li><li class="dropdown-subitem"><a href="/houduan/springboot.html" class="nav-link">
  springboot
</a></li><li class="dropdown-subitem"><a href="/houduan/redis.html" class="nav-link">
  redis
</a></li><li class="dropdown-subitem"><a href="/houduan/springsecurity.html" class="nav-link">
  springsecurity
</a></li></ul></li><li class="dropdown-item"><h4>
          第三阶段-微服务
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/houduan/springcloud.html" class="nav-link">
  springcloud
</a></li><li class="dropdown-subitem"><a href="/houduan/springcloudAlibaba.html" class="nav-link">
  springcloudAlibaba
</a></li><li class="dropdown-subitem"><a href="/houduan/rabbitMQ.html" class="nav-link">
  rabbitMQ
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="运维" class="dropdown-title"><span class="title">运维</span> <span class="arrow down"></span></button> <button type="button" aria-label="运维" class="mobile-dropdown-title"><span class="title">运维</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/yunwei/linux.html" class="nav-link">
  linux
</a></li><li class="dropdown-item"><!----> <a href="/yunwei/nginx.html" class="nav-link">
  nginx
</a></li><li class="dropdown-item"><!----> <a href="/yunwei/docker.html" class="nav-link">
  docker
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="高效工具" class="dropdown-title"><span class="title">高效工具</span> <span class="arrow down"></span></button> <button type="button" aria-label="高效工具" class="mobile-dropdown-title"><span class="title">高效工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/gaoxiao/vim.html" class="nav-link">
  vim
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="项目总结" class="dropdown-title"><span class="title">项目总结</span> <span class="arrow down"></span></button> <button type="button" aria-label="项目总结" class="mobile-dropdown-title"><span class="title">项目总结</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/prosummary/vueS.html" class="nav-link">
  vue项目
</a></li><li class="dropdown-item"><!----> <a href="/prosummary/javaS.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  java项目
</a></li><li class="dropdown-item"><!----> <a href="/prosummary/前后端项目开发流程.html" class="nav-link">
  前后端项目搭建
</a></li><li class="dropdown-item"><!----> <a href="/prosummary/后端知识总结.html" class="nav-link">
  后端开发流程
</a></li></ul></div></div><div class="nav-item"><a href="http://www.zch1337.xyz/#/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  关于我
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="英语" class="dropdown-title"><span class="title">英语</span> <span class="arrow down"></span></button> <button type="button" aria-label="英语" class="mobile-dropdown-title"><span class="title">英语</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/yingyu/fangfa.html" class="nav-link">
  方法
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端" class="mobile-dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/yunwei/sanjianke.html" class="nav-link">
  三剑客
</a></li><li class="dropdown-item"><!----> <a href="/yunwei/vue.html" class="nav-link">
  vue全家桶
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><span class="title">后端</span> <span class="arrow down"></span></button> <button type="button" aria-label="后端" class="mobile-dropdown-title"><span class="title">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          第一阶段-基础
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/houduan/javase.html" class="nav-link">
  javase
</a></li><li class="dropdown-subitem"><a href="/houduan/mysql.html" class="nav-link">
  mysql
</a></li><li class="dropdown-subitem"><a href="/houduan/jdbc.html" class="nav-link">
  jdbc
</a></li><li class="dropdown-subitem"><a href="/houduan/servlet.html" class="nav-link">
  servlet
</a></li></ul></li><li class="dropdown-item"><h4>
          第二阶段-框架
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/houduan/maven.html" class="nav-link">
  maven
</a></li><li class="dropdown-subitem"><a href="/houduan/spring.html" class="nav-link">
  spring
</a></li><li class="dropdown-subitem"><a href="/houduan/springMVC.html" class="nav-link">
  springMVC
</a></li><li class="dropdown-subitem"><a href="/houduan/mybatis+PLUS.html" class="nav-link">
  mybatis+PLUS
</a></li><li class="dropdown-subitem"><a href="/houduan/springboot.html" class="nav-link">
  springboot
</a></li><li class="dropdown-subitem"><a href="/houduan/redis.html" class="nav-link">
  redis
</a></li><li class="dropdown-subitem"><a href="/houduan/springsecurity.html" class="nav-link">
  springsecurity
</a></li></ul></li><li class="dropdown-item"><h4>
          第三阶段-微服务
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/houduan/springcloud.html" class="nav-link">
  springcloud
</a></li><li class="dropdown-subitem"><a href="/houduan/springcloudAlibaba.html" class="nav-link">
  springcloudAlibaba
</a></li><li class="dropdown-subitem"><a href="/houduan/rabbitMQ.html" class="nav-link">
  rabbitMQ
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="运维" class="dropdown-title"><span class="title">运维</span> <span class="arrow down"></span></button> <button type="button" aria-label="运维" class="mobile-dropdown-title"><span class="title">运维</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/yunwei/linux.html" class="nav-link">
  linux
</a></li><li class="dropdown-item"><!----> <a href="/yunwei/nginx.html" class="nav-link">
  nginx
</a></li><li class="dropdown-item"><!----> <a href="/yunwei/docker.html" class="nav-link">
  docker
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="高效工具" class="dropdown-title"><span class="title">高效工具</span> <span class="arrow down"></span></button> <button type="button" aria-label="高效工具" class="mobile-dropdown-title"><span class="title">高效工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/gaoxiao/vim.html" class="nav-link">
  vim
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="项目总结" class="dropdown-title"><span class="title">项目总结</span> <span class="arrow down"></span></button> <button type="button" aria-label="项目总结" class="mobile-dropdown-title"><span class="title">项目总结</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/prosummary/vueS.html" class="nav-link">
  vue项目
</a></li><li class="dropdown-item"><!----> <a href="/prosummary/javaS.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  java项目
</a></li><li class="dropdown-item"><!----> <a href="/prosummary/前后端项目开发流程.html" class="nav-link">
  前后端项目搭建
</a></li><li class="dropdown-item"><!----> <a href="/prosummary/后端知识总结.html" class="nav-link">
  后端开发流程
</a></li></ul></div></div><div class="nav-item"><a href="http://www.zch1337.xyz/#/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  关于我
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>后端项目总结</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/prosummary/javaS.html#_1-模块化搭建项目" class="sidebar-link">1.模块化搭建项目</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/prosummary/javaS.html#_2-swagger和集成knife4j" class="sidebar-link">2.Swagger和集成knife4j</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/prosummary/javaS.html#_2-1依赖" class="sidebar-link">2.1依赖</a></li><li class="sidebar-sub-header"><a href="/prosummary/javaS.html#_2-2添加knife4j配置类" class="sidebar-link">2.2添加knife4j配置类</a></li><li class="sidebar-sub-header"><a href="/prosummary/javaS.html#_2-3controller层添加注解" class="sidebar-link">2.3Controller层添加注解</a></li><li class="sidebar-sub-header"><a href="/prosummary/javaS.html#_2-4测试" class="sidebar-link">2.4测试</a></li></ul></li><li><a href="/prosummary/javaS.html#_3-前后端交换数据" class="sidebar-link">3.前后端交换数据</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/prosummary/javaS.html#_3-1响应格式封装vo类-1" class="sidebar-link">3.1响应格式封装Vo类-(1)</a></li><li class="sidebar-sub-header"><a href="/prosummary/javaS.html#_3-2json统一交换格式" class="sidebar-link">3.2JSON统一交换格式</a></li><li class="sidebar-sub-header"><a href="/prosummary/javaS.html#_3-3-url传参" class="sidebar-link">3.3 URL传参</a></li><li class="sidebar-sub-header"><a href="/prosummary/javaS.html#_3-4-deletemapping接口" class="sidebar-link">3.4@DeleteMapping接口</a></li><li class="sidebar-sub-header"><a href="/prosummary/javaS.html#_3-5响应格式封装r-2" class="sidebar-link">3.5响应格式封装R-(2)</a></li><li class="sidebar-sub-header"><a href="/prosummary/javaS.html#_3-6处理日期" class="sidebar-link">3.6处理日期</a></li></ul></li><li><a href="/prosummary/javaS.html#_4-前端的一些知识" class="sidebar-link">4.前端的一些知识</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/prosummary/javaS.html#_4-1js模块化" class="sidebar-link">4.1JS模块化</a></li><li class="sidebar-sub-header"><a href="/prosummary/javaS.html#_4-2使用框架搭建环境" class="sidebar-link">4.2使用框架搭建环境</a></li></ul></li><li><a href="/prosummary/javaS.html#_5-mybatisplus" class="sidebar-link">5.MybatisPlus</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/prosummary/javaS.html#_5-1配置" class="sidebar-link">5.1配置</a></li><li class="sidebar-sub-header"><a href="/prosummary/javaS.html#_5-2使用" class="sidebar-link">5.2使用</a></li></ul></li><li><a href="/prosummary/javaS.html#_6-字面量封装" class="sidebar-link">6.字面量封装</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/prosummary/javaS.html#_7-博客表浏览量-并发优化" class="sidebar-link">7.博客表浏览量 并发优化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/prosummary/javaS.html#_1-commandlinerunner实现项目启动时预处理" class="sidebar-link">1.CommandLineRunner实现项目启动时预处理</a></li><li class="sidebar-sub-header"><a href="/prosummary/javaS.html#_2-定时任务" class="sidebar-link">2.定时任务</a></li></ul></li><li><a href="/prosummary/javaS.html#_8-aop实现日志记录" class="sidebar-link">8.AOP实现日志记录</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/prosummary/javaS.html#_9-上传头像" class="sidebar-link">9.上传头像</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/prosummary/javaS.html#_10-swagger2" class="sidebar-link">10.Swagger2</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/prosummary/javaS.html#_11-动态路由" class="sidebar-link">11.动态路由</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/prosummary/javaS.html#_12-注解事务" class="sidebar-link">12.注解事务</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/prosummary/javaS.html#_13-导出和导入功能" class="sidebar-link">13.导出和导入功能</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/prosummary/javaS.html#_1-依赖" class="sidebar-link">1.依赖</a></li><li class="sidebar-sub-header"><a href="/prosummary/javaS.html#_2-一些工具" class="sidebar-link">2.一些工具</a></li><li class="sidebar-sub-header"><a href="/prosummary/javaS.html#_3-controller" class="sidebar-link">3.Controller</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="_1-模块化搭建项目"><a href="#_1-模块化搭建项目" class="header-anchor">#</a> 1.模块化搭建项目</h2> <h2 id="_2-swagger和集成knife4j"><a href="#_2-swagger和集成knife4j" class="header-anchor">#</a> 2.Swagger和集成knife4j</h2> <h3 id="_2-1依赖"><a href="#_2-1依赖" class="header-anchor">#</a> 2.1依赖</h3> <div class="language- extra-class"><pre class="language-text"><code>&lt;dependency&gt;
    &lt;groupId&gt;com.github.xiaoymin&lt;/groupId&gt;
    &lt;artifactId&gt;knife4j-spring-boot-starter&lt;/artifactId&gt;
&lt;/dependency&gt;
注意 这个依赖容易和其他的依赖冲突，导致加载不了注解
解决办法：把相关的依赖删掉
</code></pre></div><h3 id="_2-2添加knife4j配置类"><a href="#_2-2添加knife4j配置类" class="header-anchor">#</a> 2.2添加knife4j配置类</h3> <div class="language- extra-class"><pre class="language-text"><code>import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import springfox.documentation.builders.ApiInfoBuilder;
import springfox.documentation.builders.ParameterBuilder;
import springfox.documentation.builders.PathSelectors;
import springfox.documentation.builders.RequestHandlerSelectors;
import springfox.documentation.schema.ModelRef;
import springfox.documentation.service.ApiInfo;
import springfox.documentation.service.Contact;
import springfox.documentation.service.Parameter;
import springfox.documentation.spi.DocumentationType;
import springfox.documentation.spring.web.plugins.Docket;
import springfox.documentation.swagger2.annotations.EnableSwagger2WebMvc;

import java.util.ArrayList;
import java.util.List;

/**
 * knife4j配置信息
 */
@Configuration
@EnableSwagger2WebMvc
public class Knife4jConfig {

    @Bean
    public Docket adminApiConfig(){
        List&lt;Parameter&gt; pars = new ArrayList&lt;&gt;();
        ParameterBuilder tokenPar = new ParameterBuilder();
        tokenPar.name(&quot;token&quot;)
                .description(&quot;用户token&quot;)
                .defaultValue(&quot;&quot;)
                .modelRef(new ModelRef(&quot;string&quot;))
                .parameterType(&quot;header&quot;)
                .required(false)
                .build();
        pars.add(tokenPar.build());
        //添加head参数end

        Docket adminApi = new Docket(DocumentationType.SWAGGER_2)
                .groupName(&quot;adminApi&quot;)
                .apiInfo(adminApiInfo())
                .select()
                //只显示admin路径下的页面 
                .apis(RequestHandlerSelectors.basePackage(&quot;com.atguigu&quot;))
                .paths(PathSelectors.regex(&quot;/admin/.*&quot;))
                .build()
                .globalOperationParameters(pars);
        return adminApi;
    }

    private ApiInfo adminApiInfo(){

        return new ApiInfoBuilder()
                .title(&quot;后台管理系统-API文档&quot;)
                .description(&quot;本文档描述了后台管理系统微服务接口定义&quot;)
                .version(&quot;1.0&quot;)
                .contact(new Contact(&quot;atguigu&quot;, &quot;http://atguigu.com&quot;, &quot;atguigu@qq.com&quot;))
                .build();
    }


}
</code></pre></div><h3 id="_2-3controller层添加注解"><a href="#_2-3controller层添加注解" class="header-anchor">#</a> 2.3Controller层添加注解</h3> <div class="language- extra-class"><pre class="language-text"><code>//在类上面添加 @Api(tags = &quot;egs&quot;)
@Api(tags = &quot;角色管理&quot;)

@RestController
@RequestMapping(&quot;/admin/system/sysRole&quot;)
public class SysRoleController {
@Autowired
private SysRoleService sysRoleService;
//在方法上面添加 @ApiOperation(value = &quot;获取全部角色列表&quot;)
@ApiOperation(value = &quot;获取全部角色列表&quot;)
@GetMapping(&quot;findAll&quot;)
public Result&lt;List&lt;SysRole&gt;&gt; findAll() {
    List&lt;SysRole&gt; roleList = sysRoleService.list();
    return Result.ok(roleList);
}
</code></pre></div><h3 id="_2-4测试"><a href="#_2-4测试" class="header-anchor">#</a> 2.4测试</h3> <p>http://localhost:8800/doc.html</p> <h2 id="_3-前后端交换数据"><a href="#_3-前后端交换数据" class="header-anchor">#</a> 3.前后端交换数据</h2> <h3 id="_3-1响应格式封装vo类-1"><a href="#_3-1响应格式封装vo类-1" class="header-anchor">#</a> 3.1响应格式封装Vo类-(1)</h3> <p>Vo类是一个实体类</p> <p>可以前端给后端传 使用vo类来接收--方便封装数据</p> <p>可以后端给前端返回 使用vo类封装--方便返回特定的数据</p> <div class="language- extra-class"><pre class="language-text"><code>import lombok.AllArgsConstructor;
import lombok.Data;
import lombok.NoArgsConstructor;

import java.util.Date;

@Data
@AllArgsConstructor
@NoArgsConstructor
public class ArticleDetailVo {
    private Long id;
    //文章摘要
    private String summary;
    //所属分类id
    private Long categoryId;
    //所属分类名
    private String categoryName;
    //缩略图
    private String thumbnail;
    //文章内容
    private String content;
    //访问量
    private Long viewCount;
    //发布时间
    private Date createTime;
}
</code></pre></div><h3 id="_3-2json统一交换格式"><a href="#_3-2json统一交换格式" class="header-anchor">#</a> 3.2JSON统一交换格式</h3> <p>比如后端需要这么一个数据 [1,2,3]</p> <p>前端就传这个数据 后端 使用List&lt;Integer&gt;来接</p> <p>后端	前端</p> <p>对象	JSON对象</p> <p>数组    []</p> <p>...等等 是相互对应的</p> <h3 id="_3-3-url传参"><a href="#_3-3-url传参" class="header-anchor">#</a> 3.3 URL传参</h3> <div class="language- extra-class"><pre class="language-text"><code>// 地址栏传参
@ApiOperation(&quot;根据id查询&quot;)
@PostMapping(&quot;findRoleById/{id}&quot;)
public Result findRoleById(@PathVariable(&quot;id&quot;) Long id) { // 使用@PathVariable（&quot;id&quot;）来接收
    SysRole sysRole = sysRoleService.getById(id);
    return Result.ok(sysRole);
}
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>@ApiOperation(&quot;条件分页查询&quot;)
@GetMapping(&quot;{page}/{limit}&quot;)
public Result findPageQueryRole(@PathVariable Long page,
                                @PathVariable Long limit, SysRoleQueryVo sysRoleQueryVo) {
    //从地址栏上拿数据 封装到VO类中
    //创建page对象
    Page&lt;SysRole&gt; pageParam = new Page&lt;&gt;(page, limit);
    //调用service方法
    IPage&lt;SysRole&gt; pageModel = sysRoleService.selectPage(pageParam, sysRoleQueryVo);
    return Result.ok(pageModel);
}
</code></pre></div><h3 id="_3-4-deletemapping接口"><a href="#_3-4-deletemapping接口" class="header-anchor">#</a> 3.4@DeleteMapping接口</h3> <p>数据是放到请求体中的 后端用@RequestBody来拿</p> <div class="language- extra-class"><pre class="language-text"><code>@ApiOperation(&quot;批量逻辑删除&quot;)
@DeleteMapping(&quot;batchRemove&quot;)
public Result batchRemoveRoles(@RequestBody List&lt;Long&gt; ids) {
    //获取多个id值
    //1. [1,2,3]  配合@RequestBody List&lt;Long&gt; ids  json中的数据
    //前后端 对象和json对应的    双向的
    sysRoleService.removeByIds(ids);
    return Result.ok();
}
</code></pre></div><h3 id="_3-5响应格式封装r-2"><a href="#_3-5响应格式封装r-2" class="header-anchor">#</a> 3.5响应格式封装R-(2)</h3> <p>R.java</p> <div class="language- extra-class"><pre class="language-text"><code>注意 用了jackson依赖
import com.fasterxml.jackson.annotation.JsonInclude;
import xyz.zch1337.domain.enums.AppHttpCodeEnum;

import java.io.Serializable;

@JsonInclude(JsonInclude.Include.NON_NULL)
public class R&lt;T&gt; implements Serializable {
    private Integer code;
    private String msg;
    private T data;

    public R() {
        this.code = AppHttpCodeEnum.SUCCESS.getCode();
        this.msg = AppHttpCodeEnum.SUCCESS.getMsg();
    }

    public R(Integer code, T data) {
        this.code = code;
        this.data = data;
    }

    public R(Integer code, String msg, T data) {
        this.code = code;
        this.msg = msg;
        this.data = data;
    }

    public R(Integer code, String msg) {
        this.code = code;
        this.msg = msg;
    }

    public static R errorResult(int code, String msg) {
        R result = new R();
        return result.error(code, msg);
    }
    public static R okResult() {
        R result = new R();
        return result;
    }
    public static R okResult(int code, String msg) {
        R result = new R();
        return result.ok(code, null, msg);
    }

    public static R okResult(Object data) {
        R result = setAppHttpCodeEnum(AppHttpCodeEnum.SUCCESS, AppHttpCodeEnum.SUCCESS.getMsg());
        if(data!=null) {
            result.setData(data);
        }
        return result;
    }

    public static R errorResult(AppHttpCodeEnum enums){
        return setAppHttpCodeEnum(enums,enums.getMsg());
    }

    public static R errorResult(AppHttpCodeEnum enums, String msg){
        return setAppHttpCodeEnum(enums,msg);
    }

    public static R setAppHttpCodeEnum(AppHttpCodeEnum enums){
        return okResult(enums.getCode(),enums.getMsg());
    }

    private static R setAppHttpCodeEnum(AppHttpCodeEnum enums, String msg){
        return okResult(enums.getCode(),msg);
    }

    public R&lt;?&gt; error(Integer code, String msg) {
        this.code = code;
        this.msg = msg;
        return this;
    }

    public R&lt;?&gt; ok(Integer code, T data) {
        this.code = code;
        this.data = data;
        return this;
    }

    public R&lt;?&gt; ok(Integer code, T data, String msg) {
        this.code = code;
        this.data = data;
        this.msg = msg;
        return this;
    }

    public R&lt;?&gt; ok(T data) {
        this.data = data;
        return this;
    }

    public Integer getCode() {
        return code;
    }

    public void setCode(Integer code) {
        this.code = code;
    }

    public String getMsg() {
        return msg;
    }

    public void setMsg(String msg) {
        this.msg = msg;
    }

    public T getData() {
        return data;
    }

    public void setData(T data) {
        this.data = data;
    }
    
}
</code></pre></div><p>枚举类AppHttpCodeEnum.java</p> <div class="language- extra-class"><pre class="language-text"><code>public enum AppHttpCodeEnum {
    // 成功
    SUCCESS(200,&quot;操作成功&quot;),
    // 登录
    NEED_LOGIN(401,&quot;需要登录后操作&quot;),
    NO_OPERATOR_AUTH(403,&quot;无权限操作&quot;),
    SYSTEM_ERROR(500,&quot;出现错误&quot;),
    USERNAME_EXIST(501,&quot;用户名已存在&quot;),
    PHONENUMBER_EXIST(502,&quot;手机号已存在&quot;), EMAIL_EXIST(503, &quot;邮箱已存在&quot;),
    REQUIRE_USERNAME(504, &quot;必需填写用户名&quot;),
    LOGIN_ERROR(505,&quot;用户名或密码错误&quot;);
    int code;
    String msg;

    AppHttpCodeEnum(int code, String errorMessage){
        this.code = code;
        this.msg = errorMessage;
    }

    public int getCode() {
        return code;
    }

    public String getMsg() {
        return msg;
    }
}
</code></pre></div><h3 id="_3-6处理日期"><a href="#_3-6处理日期" class="header-anchor">#</a> 3.6处理日期</h3> <div class="language- extra-class"><pre class="language-text"><code>添加配置转换器

WebConfig


import com.alibaba.fastjson.serializer.SerializeConfig;
import com.alibaba.fastjson.serializer.SerializerFeature;
import com.alibaba.fastjson.serializer.ToStringSerializer;
import com.alibaba.fastjson.support.config.FastJsonConfig;
import com.alibaba.fastjson.support.spring.FastJsonHttpMessageConverter;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.http.converter.HttpMessageConverter;
import org.springframework.web.servlet.config.annotation.CorsRegistry;
import org.springframework.web.servlet.config.annotation.WebMvcConfigurer;

import java.util.List;

@Configuration
public class WebConfig implements WebMvcConfigurer {
    // 开启跨域访问
    @Override
    public void addCorsMappings(CorsRegistry registry) {
        // 设置允许跨域的路径
        registry.addMapping(&quot;/**&quot;)
                // 设置允许跨域请求的域名
                .allowedOriginPatterns(&quot;*&quot;)
                // 是否允许cookie
                .allowCredentials(true)
                // 设置允许的请求方式
                .allowedMethods(&quot;GET&quot;, &quot;POST&quot;, &quot;DELETE&quot;, &quot;PUT&quot;)
                // 设置允许的header属性
                .allowedHeaders(&quot;*&quot;)
                // 跨域允许时间
                .maxAge(3600);
    }

    // 配置转换器
    @Override
    public void configureMessageConverters(List&lt;HttpMessageConverter&lt;?&gt;&gt; converters) {
        converters.add(fastJsonHttpMessageConverters());
    }
    // 转换日期格式
    @Bean//使用@Bean注入fastJsonHttpMessageConvert
    public HttpMessageConverter fastJsonHttpMessageConverters() {
        //1.需要定义一个Convert转换消息的对象
        FastJsonHttpMessageConverter fastConverter = new FastJsonHttpMessageConverter();
        FastJsonConfig fastJsonConfig = new FastJsonConfig();
        fastJsonConfig.setSerializerFeatures(SerializerFeature.PrettyFormat);
        fastJsonConfig.setDateFormat(&quot;yyyy-MM-dd HH:mm:ss&quot;);

        SerializeConfig.globalInstance.put(Long.class, ToStringSerializer.instance);

        fastJsonConfig.setSerializeConfig(SerializeConfig.globalInstance);
        fastConverter.setFastJsonConfig(fastJsonConfig);
        HttpMessageConverter&lt;?&gt; converter = fastConverter;
        return converter;
    }
    
}
</code></pre></div><h2 id="_4-前端的一些知识"><a href="#_4-前端的一些知识" class="header-anchor">#</a> 4.前端的一些知识</h2> <h3 id="_4-1js模块化"><a href="#_4-1js模块化" class="header-anchor">#</a> 4.1JS模块化</h3> <h4 id="es5"><a href="#es5" class="header-anchor">#</a> ES5</h4> <div class="language- extra-class"><pre class="language-text"><code>01.js
// 定义成员：
const sum = function(a,b){
    return parseInt(a) + parseInt(b)
}
const subtract = function(a,b){
    return parseInt(a) - parseInt(b)
}

// 导出成员：
//简写
module.exports = {
    sum,
    subtract
}

ES5用法
//引入模块，注意：当前路径必须写 ./
const m = require('./四则运算.js')
</code></pre></div><h4 id="es6"><a href="#es6" class="header-anchor">#</a> ES6</h4> <p>底层是先转5再运行</p> <div class="language- extra-class"><pre class="language-text"><code>写法1
export function getList() {
    console.log('获取数据列表')
}
export function save() {
    console.log('保存数据')
}
ES6用法
import { getList, save } from &quot;./userApi.js&quot;
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>写法2
export default {
    getList() {
        console.log('获取数据列表2')
    },
    save() {
        console.log('保存数据2')
    }
}


import user from &quot;./userApi2.js&quot;
</code></pre></div><h3 id="_4-2使用框架搭建环境"><a href="#_4-2使用框架搭建环境" class="header-anchor">#</a> 4.2使用框架搭建环境</h3> <p>vue-element-admin</p> <div class="language- extra-class"><pre class="language-text"><code>npm install
npm run dev
</code></pre></div><h2 id="_5-mybatisplus"><a href="#_5-mybatisplus" class="header-anchor">#</a> 5.MybatisPlus</h2> <h3 id="_5-1配置"><a href="#_5-1配置" class="header-anchor">#</a> 5.1配置</h3> <div class="language- extra-class"><pre class="language-text"><code>1.依赖
        &lt;!--mybatisPlus依赖--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.baomidou&lt;/groupId&gt;
            &lt;artifactId&gt;mybatis-plus-boot-starter&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;!--mysql数据库驱动--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;mysql&lt;/groupId&gt;
            &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;
        &lt;/dependency&gt;
2.yml文件配置
spring:
  datasource:
    url: jdbc:mysql://124.222.237.176:3306/zch_blog?characterEncoding=utf-8&amp;serverTimezone=Asia/Shanghai
    username: root
    password: 123456
    driver-class-name: com.mysql.cj.jdbc.Driver
  servlet:
    multipart:
      max-file-size: 2MB
      max-request-size: 5MB
mybatis-plus:
  configuration:
    # 日志
    log-impl: org.apache.ibatis.logging.stdout.StdOutImpl
  global-config:
    db-config:
      logic-delete-field: delFlag
      logic-delete-value: 1
      logic-not-delete-value: 0
      id-type: auto
3.idea连接数据库
4.easycode模板
     注意 删除前缀
</code></pre></div><p>entity</p> <div class="language- extra-class"><pre class="language-text"><code>##导入宏定义
$!{define.vm}

##保存文件（宏定义）
#save(&quot;/entity&quot;, &quot;.java&quot;)

##包路径（宏定义）
#setPackageSuffix(&quot;entity&quot;)

##自动导入包（全局变量）
$!{autoImport.vm}

import java.io.Serializable;
import lombok.AllArgsConstructor;
import lombok.Data;
import lombok.NoArgsConstructor;
import com.baomidou.mybatisplus.annotation.TableId;
import com.baomidou.mybatisplus.annotation.TableName;
##表注释（宏定义）
#tableComment(&quot;表实体类&quot;)
@SuppressWarnings(&quot;serial&quot;)
@Data
@AllArgsConstructor
@NoArgsConstructor
@TableName(&quot;$!{tableInfo.obj.name}&quot;)
public class $!{tableInfo.name}  {
#foreach($column in $tableInfo.pkColumn)
    #if(${column.comment})//${column.comment}#end
@TableId
    private $!{tool.getClsNameByFullName($column.type)} $!{column.name};
#end

#foreach($column in $tableInfo.otherColumn)
    #if(${column.comment})//${column.comment}#end

    private $!{tool.getClsNameByFullName($column.type)} $!{column.name};
#end

}
</code></pre></div><p>mapper</p> <div class="language- extra-class"><pre class="language-text"><code>##导入宏定义
$!{define.vm}

##设置表后缀（宏定义）
#setTableSuffix(&quot;Mapper&quot;)

##保存文件（宏定义）
#save(&quot;/mapper&quot;, &quot;Mapper.java&quot;)

##包路径（宏定义）
#setPackageSuffix(&quot;mapper&quot;)

import com.baomidou.mybatisplus.core.mapper.BaseMapper;
import $!{tableInfo.savePackageName}.entity.$!tableInfo.name;

##表注释（宏定义）
#tableComment(&quot;表数据库访问层&quot;)
public interface $!{tableName} extends BaseMapper&lt;$!tableInfo.name&gt; {

}

</code></pre></div><p>service</p> <div class="language- extra-class"><pre class="language-text"><code>##导入宏定义
$!{define.vm}

##设置表后缀（宏定义）
#setTableSuffix(&quot;Service&quot;)

##保存文件（宏定义）
#save(&quot;/service&quot;, &quot;Service.java&quot;)

##包路径（宏定义）
#setPackageSuffix(&quot;service&quot;)

import com.baomidou.mybatisplus.extension.service.IService;
import $!{tableInfo.savePackageName}.entity.$!tableInfo.name;

##表注释（宏定义）
#tableComment(&quot;表服务接口&quot;)
public interface $!{tableName} extends IService&lt;$!tableInfo.name&gt; {

}

</code></pre></div><p>serviceImpl</p> <div class="language- extra-class"><pre class="language-text"><code>##导入宏定义
$!{define.vm}

##设置表后缀（宏定义）
#setTableSuffix(&quot;ServiceImpl&quot;)

##保存文件（宏定义）
#save(&quot;/service/impl&quot;, &quot;ServiceImpl.java&quot;)

##包路径（宏定义）
#setPackageSuffix(&quot;service.impl&quot;)

import com.baomidou.mybatisplus.extension.service.impl.ServiceImpl;
import $!{tableInfo.savePackageName}.mapper.$!{tableInfo.name}Mapper;
import $!{tableInfo.savePackageName}.entity.$!{tableInfo.name};
import $!{tableInfo.savePackageName}.service.$!{tableInfo.name}Service;
import org.springframework.stereotype.Service;

##表注释（宏定义）
#tableComment(&quot;表服务实现类&quot;)
@Service
##@Service(&quot;$!tool.firstLowerCase($tableInfo.name)Service&quot;)
public class $!{tableName} extends ServiceImpl&lt;$!{tableInfo.name}Mapper, $!{tableInfo.name}&gt; implements $!{tableInfo.name}Service {

}

</code></pre></div><h3 id="_5-2使用"><a href="#_5-2使用" class="header-anchor">#</a> 5.2使用</h3> <div class="language- extra-class"><pre class="language-text"><code>1.基本使用
在serviceImpl中
直接使用方法，不需要注入mapper了
使用其他service 需要注入
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>        LambdaQueryWrapper&lt;Link&gt; queryWrapper = new LambdaQueryWrapper&lt;&gt;();
        queryWrapper.eq(Link::getStatus, SystemConstants.LINK_STATUS_NORMAL);
        List&lt;Link&gt; list = list(queryWrapper);
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>2.进阶使用 动态sql
	1.判断 值是否为空 不为空就加入条件
    // 如果有categoryId 加入条件
    queryWrapper.eq(Objects.nonNull(categoryId) &amp;&amp; categoryId &gt; 0, Article::getCategoryId, categoryId);	
    2.排序功能
    // 实现文章置顶功能 对isTop进行降序
    queryWrapper.orderByDesc(Article::getIsTop)

</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>3.分页查询
	//创建page对象
	Page&lt;Article&gt; page = new Page&lt;&gt;(pageNum, pageSize);
	//带条件分页查询
	page(page, queryWrapper);
	//拿到分页的结果
	List&lt;Article&gt; articles = page.getRecords();
注意：	需要添加分页拦截器
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>MbatisPlusConfig

@Configuration
public class MbatisPlusConfig {

    /**
     * 3.4.0之后版本
     * mybatis 分页拦截器
     * @return
     */
    @Bean
    public MybatisPlusInterceptor mybatisPlusInterceptor(){
        MybatisPlusInterceptor mybatisPlusInterceptor = new MybatisPlusInterceptor();
        mybatisPlusInterceptor.addInnerInterceptor(new PaginationInnerInterceptor());
        return mybatisPlusInterceptor;
    }
}
</code></pre></div><h2 id="_6-字面量封装"><a href="#_6-字面量封装" class="header-anchor">#</a> 6.字面量封装</h2> <div class="language- extra-class"><pre class="language-text"><code>SystemConstants

public class SystemConstants
{
    /**
     *  文章是草稿
     */
    public static final int ARTICLE_STATUS_DRAFT = 1;
    /**
     *  文章是正常发布状态
     */
    public static final int ARTICLE_STATUS_NORMAL = 0;

    public static final String STATUS_NORMAL = &quot;0&quot;;

    /**
     *  友链审核通过是正常状态
     */
    public static final String LINK_STATUS_NORMAL = &quot;0&quot;;
}

</code></pre></div><h2 id="_7-博客表浏览量-并发优化"><a href="#_7-博客表浏览量-并发优化" class="header-anchor">#</a> 7.博客表浏览量 并发优化</h2> <p>使用redis，来优化</p> <p>1.程序初始化时，从数据库查到数据，存放到redis</p> <p>2.前端通过在redis中查数据并返回</p> <p>3.当用户一点击（调用接口) 时，redis中数据加1</p> <p>4.定期 从redis拿数据更加数据库</p> <p>理解就是：</p> <p>在开始时：查数据库放到redis中</p> <p>从redis读</p> <p>在redis增加</p> <p>定时从redis读到数据库中</p> <h3 id="_1-commandlinerunner实现项目启动时预处理"><a href="#_1-commandlinerunner实现项目启动时预处理" class="header-anchor">#</a> 1.CommandLineRunner实现项目启动时预处理</h3> <div class="language- extra-class"><pre class="language-text"><code>写ViewCountRunner实现CommandLineRunner --基于springboot
注意：@Component 注入容器

@Component
public class ViewCountRunner implements CommandLineRunner {

    @Autowired
    private ArticleMapper articleMapper;

    @Autowired
    private RedisCache redisCache;
    @Override
    public void run(String... args) throws Exception {
        // 查浏览量
        List&lt;Article&gt; articles = articleMapper.selectList(null);
        Map&lt;String, Integer&gt; viewCountMap = articles.stream()
                .collect(Collectors.toMap(article -&gt; article.getId().toString(), article -&gt; {
                    return article.getViewCount().intValue();
                }));
        // 存到redis
        redisCache.setCacheMap(&quot;article:viewCount&quot;,viewCountMap);
        System.out.println(&quot;把浏览量封装给map并存到redis&quot;);
    }
}


</code></pre></div><h3 id="_2-定时任务"><a href="#_2-定时任务" class="header-anchor">#</a> 2.定时任务</h3> <p>基于springboot</p> <div class="language- extra-class"><pre class="language-text"><code>1.开启定时任务

@SpringBootApplication
@MapperScan(&quot;xyz.zch1337.mapper&quot;)
@EnableScheduling // 开启定时任务
public class ZCHBlogApplication {
    public static void main(String[] args) {
        SpringApplication.run(ZCHBlogApplication.class,args);
    }
}

2.确定定时任务执行代码，并配置任务执行时间
@Scheduled注解标识需要定时执行的代码。注解的cron属性相当于是任务的执行时间
注意：@Component 注入容器

Cron表达式 =&gt;  https://www.bejson.com/othertools/cron/

@Component
public class UpdateViewCountJob {

    @Autowired
    private RedisCache redisCache;

    @Autowired
    private ArticleService articleService;
    @Scheduled(cron = &quot;0/5 * * * * ?&quot;)  // 在方法上添加注解 cron表达式为任务的执行时间
    public void testJob() {
        // 在redis中查询浏览量
        Map&lt;String, Integer&gt; viewCountMap = redisCache.getCacheMap(&quot;article:viewCount&quot;);

        List&lt;Article&gt; articles = viewCountMap.entrySet()
                .stream()
                .map(entry -&gt; new Article(Long.valueOf(entry.getKey()), entry.getValue().longValue()))
                .collect(Collectors.toList());
        // 更新到mysql中
        articleService.updateBatchById(articles);
    }
}
</code></pre></div><p>3.实现代码</p> <div class="language- extra-class"><pre class="language-text"><code>1.程序初始化时，从数据库查到数据，存放到redis
@Component
public class ViewCountRunner implements CommandLineRunner {

    @Autowired
    private ArticleMapper articleMapper;

    @Autowired
    private RedisCache redisCache;
    @Override
    public void run(String... args) throws Exception {
        // 查浏览量
        List&lt;Article&gt; articles = articleMapper.selectList(null);
        Map&lt;String, Integer&gt; viewCountMap = articles.stream()
                .collect(Collectors.toMap(article -&gt; article.getId().toString(), article -&gt; {
                    return article.getViewCount().intValue();
                }));
        // 存到redis
        redisCache.setCacheMap(&quot;article:viewCount&quot;,viewCountMap);
        System.out.println(&quot;把浏览量封装给map并存到redis&quot;);
    }
}

2.前端通过在redis中查数据并返回

    public R getArticleDetail(Long id) {
        // 根据id查询文章
        Article article = getById(id);
        // 去redis中查询浏览量
        Integer viewCount = redisCache.getCacheMapValue(&quot;article:viewCount&quot;, article.getId().toString());
        article.setViewCount(viewCount.longValue());
        // 转换为Vo
        ArticleDetailVo articleDetailVo = BeanCopyUtils.copyBean(article, ArticleDetailVo.class);
        // 根据分类id查询分类名
        Category category = categoryService.getById(articleDetailVo.getCategoryId());
        if (category != null) {
            articleDetailVo.setCategoryName(category.getName());
        }
        // 封装响应返回
        return R.okResult(articleDetailVo);
    }

3.当用户一点击（调用接口) 时，redis中数据加1

    public R updateViewCount(Long id) {
        redisCache.incrementCacheMapValue(&quot;article:viewCount&quot;,id.toString(),1);
        return R.okResult();
    }
	
	RedisCacha
	
	public void incrementCacheMapValue(String key,String hKey,long v){
        redisTemplate.boundHashOps(key).increment(hKey, v);
    }	
    
4.定期 从redis拿数据更加数据库

 	1.开启定时任务

@SpringBootApplication
@MapperScan(&quot;xyz.zch1337.mapper&quot;)
@EnableScheduling // 开启定时任务
public class ZCHBlogApplication {
    public static void main(String[] args) {
        SpringApplication.run(ZCHBlogApplication.class,args);
    }
}

	2.确定定时任务执行代码，并配置任务执行时间
@Scheduled注解标识需要定时执行的代码。注解的cron属性相当于是任务的执行时间
注意：@Component 注入容器

Cron表达式 =&gt;  https://www.bejson.com/othertools/cron/

@Component
public class UpdateViewCountJob {

    @Autowired
    private RedisCache redisCache;

    @Autowired
    private ArticleService articleService;
    @Scheduled(cron = &quot;0/5 * * * * ?&quot;)  // 在方法上添加注解 cron表达式为任务的执行时间
    public void testJob() {
        // 在redis中查询浏览量
        Map&lt;String, Integer&gt; viewCountMap = redisCache.getCacheMap(&quot;article:viewCount&quot;);

        List&lt;Article&gt; articles = viewCountMap.entrySet()
                .stream()
                .map(entry -&gt; new Article(Long.valueOf(entry.getKey()), entry.getValue().longValue()))
                .collect(Collectors.toList());
        // 更新到mysql中
        articleService.updateBatchById(articles);
    }
}



</code></pre></div><h2 id="_8-aop实现日志记录"><a href="#_8-aop实现日志记录" class="header-anchor">#</a> 8.AOP实现日志记录</h2> <p>0.添加依赖</p> <div class="language- extra-class"><pre class="language-text"><code>        &lt;!--AOP--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-aop&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;!--lombk--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
            &lt;artifactId&gt;lombok&lt;/artifactId&gt;
            &lt;optional&gt;true&lt;/optional&gt;
        &lt;/dependency&gt;
</code></pre></div><p>1.自定义注解</p> <div class="language- extra-class"><pre class="language-text"><code>@Retention(RetentionPolicy.RUNTIME) // 时机
@Target({ElementType.METHOD})  // 方法上使用注解
public @interface SystemLog {
    String businessName();
}
</code></pre></div><p>2.写切面类和方法</p> <div class="language- extra-class"><pre class="language-text"><code>切面类：LogAspect

import com.alibaba.fastjson.JSON;
import lombok.extern.slf4j.Slf4j;
import org.aspectj.lang.ProceedingJoinPoint;
import org.aspectj.lang.annotation.Around;
import org.aspectj.lang.annotation.Aspect;
import org.aspectj.lang.annotation.Pointcut;
import org.aspectj.lang.reflect.MethodSignature;
import org.springframework.stereotype.Component;
import org.springframework.web.context.request.RequestContextHolder;
import org.springframework.web.context.request.ServletRequestAttributes;
import xyz.zch1337.annotation.SystemLog;

import javax.servlet.http.HttpServletRequest;

@Component // 需要注入到容器中
@Aspect // 表明是切面类
@Slf4j
public class LogAspect {

    // 切点 当一个方法添加了这个注解 就给他增强
    @Pointcut(&quot;@annotation(xyz.zch1337.annotation.SystemLog)&quot;) // 使用自定义注解
    public void pt() {

    }
    // 时机
    @Around(&quot;pt()&quot;) // @Around 前后都可以
    public Object printLog(ProceedingJoinPoint joinPoint) throws Throwable { // joinPoint是被增强的方法对象
                                                                             // Throwable异常给全局异常处理
        Object ret; // ret是目标方法执行完的返回值
        try {
            handleBefore(joinPoint); // 执行目标方法之前
            ret = joinPoint.proceed(); // 执行目标方法，并得到返回值
            handleAfter(ret); // 执行目标方法之后
        } finally {
            // 打印日志信息
            // 结束后换行
            log.info(&quot;=======End=======&quot; + System.lineSeparator());
        }

        return ret; // 返回目标方法执行完的返回值 一定要返回
    }

    private void handleAfter(Object ret) {
        // 打印出参
        log.info(&quot;Response       : {}&quot;, JSON.toJSONString(ret));
    }

    private void handleBefore(ProceedingJoinPoint joinPoint) {
        // AOP中拿到request对象
        ServletRequestAttributes requestAttributes = (ServletRequestAttributes) RequestContextHolder.getRequestAttributes();
        HttpServletRequest request = requestAttributes.getRequest();

        // 获取被增强方法上的注解对象
        SystemLog systemLog = getSystemLog(joinPoint);

        log.info(&quot;=======Start=======&quot;);
        // 打印请求 URL
        log.info(&quot;URL            : {}&quot;, request.getRequestURL());
        // 打印描述信息
        log.info(&quot;BusinessName   : {}&quot;, systemLog.businessName());
        // 打印 Http method
        log.info(&quot;HTTP Method    : {}&quot;, request.getMethod());
        // 打印调用 controller 的全路径以及执行方法
        log.info(&quot;Class Method   : {}.{}&quot;, joinPoint.getSignature().getDeclaringTypeName(), ((MethodSignature)joinPoint.getSignature()).getName());
        // 打印请求的 IP
        log.info(&quot;IP             : {}&quot;, request.getRemoteHost());
        // 打印请求入参
        log.info(&quot;Request Args   : {}&quot;, JSON.toJSONString(joinPoint.getArgs()));
    }

    // 获取被增强方法上的注解对象
    private SystemLog getSystemLog(ProceedingJoinPoint joinPoint) {
        MethodSignature methodSignature = (MethodSignature) joinPoint.getSignature();
        SystemLog systemLog = methodSignature.getMethod().getAnnotation(SystemLog.class);
        return systemLog;
    }
}

</code></pre></div><h2 id="_9-上传头像"><a href="#_9-上传头像" class="header-anchor">#</a> 9.上传头像</h2> <p>一般：上传到服务器，在读取图片的时候会占用比较多的资源。影响应用服务器的性能。</p> <p>优化：后端接收到数据，上传到oss，生成的外链存到数据库并响应给前端。前端直接去oss拿</p> <div class="language- extra-class"><pre class="language-text"><code>application.yml
	oss:
  		accessKey: jZvRxwYGYmKtLdMUM6typzzweOXEuz7jHQGl1Vtw
  		secretKey: HkJm8jBonnXHUsi-9cZO9dghHpxDT5Agl0hWZPLi
  		bucket: zchtuchuang
</code></pre></div><p>controller</p> <div class="language- extra-class"><pre class="language-text"><code>@RestController
public class UploadController {
    @Autowired
    private UploadService uploadService;
    
    @PostMapping(&quot;/upload&quot;)
    public R uploadImg(MultipartFile img) {
        return uploadService.uploadImg(img);
    }
}
</code></pre></div><p>service</p> <div class="language- extra-class"><pre class="language-text"><code>public interface UploadService {
    R uploadImg(MultipartFile img);
}
</code></pre></div><p>serviceImpl</p> <div class="language- extra-class"><pre class="language-text"><code>import com.google.gson.Gson;
import com.qiniu.common.QiniuException;
import com.qiniu.http.Response;
import com.qiniu.storage.Configuration;
import com.qiniu.storage.Region;
import com.qiniu.storage.UploadManager;
import com.qiniu.storage.model.DefaultPutRet;
import com.qiniu.util.Auth;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.stereotype.Service;
import org.springframework.web.multipart.MultipartFile;
import xyz.zch1337.domain.R;
import xyz.zch1337.enums.AppHttpCodeEnum;
import xyz.zch1337.exception.SystemException;
import xyz.zch1337.service.UploadService;
import xyz.zch1337.utils.PathUtils;

import java.io.InputStream;

@Service
@ConfigurationProperties(prefix = &quot;oss&quot;) //使用yml中的数据
public class UploadServiceImpl implements UploadService {
    @Override
    public R uploadImg(MultipartFile img) {
        // 判断文件类型或者大小
        // 获取原始文件名
        String originalFilename = img.getOriginalFilename();
        if(!originalFilename.endsWith(&quot;.png&quot;)) {
            throw new SystemException(AppHttpCodeEnum.FILE_TYPE_ERROR);
        }
        // 如果通过上传到oss
        String filePath = PathUtils.generateFilePath(originalFilename);
        String url = uploadOss(img, filePath); // 2099/2/3/uuid.png
        return R.okResult(url);
    }

    private String accessKey;
    private String secretKey;
    private String bucket;

    public void setAccessKey(String accessKey) {
        this.accessKey = accessKey;
    }

    public void setSecretKey(String secretKey) {
        this.secretKey = secretKey;
    }

    public void setBucket(String bucket) {
        this.bucket = bucket;
    }

    private String uploadOss(MultipartFile img, String filePath){
        //构造一个带指定 Region 对象的配置类
        Configuration cfg = new Configuration(Region.autoRegion());

        UploadManager uploadManager = new UploadManager(cfg);
        //...生成上传凭证，然后准备上传

        //默认不指定key的情况下，以文件内容的hash值作为文件名
        String key = filePath;

        try {
            InputStream inputStream = img.getInputStream();
            Auth auth = Auth.create(accessKey, secretKey);
            String upToken = auth.uploadToken(bucket);

            try {
                Response response = uploadManager.put(inputStream,key,upToken,null, null);
                //解析上传成功的结果
                DefaultPutRet putRet = new Gson().fromJson(response.bodyString(), DefaultPutRet.class);
                System.out.println(putRet.key);
                System.out.println(putRet.hash);
//                http://rmv9watgr.hn-bkt.clouddn.com/1.png
                return &quot;http://rmv9watgr.hn-bkt.clouddn.com/&quot; + putRet.key;
            } catch (QiniuException ex) {
                Response r = ex.response;
                System.err.println(r.toString());
                try {
                    System.err.println(r.bodyString());
                } catch (QiniuException ex2) {
                    //ignore
                }
            }
        } catch (Exception ex) {
            //ignore
        }
        return &quot;errs&quot;;
    }

}
</code></pre></div><h2 id="_10-swagger2"><a href="#_10-swagger2" class="header-anchor">#</a> 10.Swagger2</h2> <p>1.依赖</p> <div class="language- extra-class"><pre class="language-text"><code>        &lt;dependency&gt;
            &lt;groupId&gt;io.springfox&lt;/groupId&gt;
            &lt;artifactId&gt;springfox-swagger2&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;io.springfox&lt;/groupId&gt;
            &lt;artifactId&gt;springfox-swagger-ui&lt;/artifactId&gt;
        &lt;/dependency&gt;
</code></pre></div><p>2.在启动类上或者配置类加 @EnableSwagger2 注解</p> <div class="language- extra-class"><pre class="language-text"><code>1.Controller配置
@Api(tags = &quot;评论&quot;,description = &quot;评论相关接口&quot;)
2.接口配置
    @GetMapping(&quot;/linkCommentList&quot;)
    @ApiOperation(value = &quot;友链评论列表&quot;,notes = &quot;获取一页友链评论&quot;)
    @ApiImplicitParams({
           @ApiImplicitParam(name = &quot;pageNum&quot;,value = &quot;页号&quot;),
           @ApiImplicitParam(name = &quot;pageSize&quot;,value = &quot;每页大小&quot;)
    }
    )
    public ResponseResult linkCommentList(Integer pageNum,Integer pageSize){
        return commentService.commentList(SystemConstants.LINK_COMMENT,null,pageNum,pageSize);
    }
3.实体类配置
@ApiModel 

@Data
@AllArgsConstructor
@NoArgsConstructor
@ApiModel(description = &quot;添加评论dto&quot;)
public class AddCommentDto{
    //..
}

@ApiModelProperty(notes = &quot;评论类型（0代表文章评论，1代表友链评论）&quot;)
    private String type;
4.文档信息信息配置

@Configuration
public class SwaggerConfig {
    @Bean
    public Docket customDocket() {
        return new Docket(DocumentationType.SWAGGER_2)
                .apiInfo(apiInfo())
                .select()
                .apis(RequestHandlerSelectors.basePackage(&quot;com.sangeng.controller&quot;))
                .build();
    }

    private ApiInfo apiInfo() {
        Contact contact = new Contact(&quot;团队名&quot;, &quot;http://www.my.com&quot;, &quot;my@my.com&quot;);
        return new ApiInfoBuilder()
                .title(&quot;文档标题&quot;)
                .description(&quot;文档描述&quot;)
                .contact(contact)   // 联系方式
                .version(&quot;1.1.0&quot;)  // 版本
                .build();
    }
}

</code></pre></div><p>3.使用</p> <div class="language- extra-class"><pre class="language-text"><code>http://localhost:7777/swagger-ui.html
</code></pre></div><h2 id="_11-动态路由"><a href="#_11-动态路由" class="header-anchor">#</a> 11.动态路由</h2> <p>根据id获取一个列表，转化为tree结构</p> <p>先写一个mapper，多表查询返回一个列表</p> <div class="language- extra-class"><pre class="language-text"><code>    private List&lt;Menu&gt; buildMenuTree(List&lt;Menu&gt; menuList) {
        List&lt;Menu&gt; tree = new ArrayList&lt;&gt;();

        for (Menu menu : menuList) {
            if (menu.getParentId() == 0) {
                //找子节点
                Menu childMenu = findChildMenu(menu, menuList);
                //赋值
                tree.add(childMenu);
            }
        }
        return tree;
    }
    
        private Menu findChildMenu(Menu menu, List&lt;Menu&gt; menuList) {
        // 初始化数据
        menu.setChildren(new ArrayList&lt;Menu&gt;());

        for (Menu menu1 : menuList) {

            if (menu.getId() == menu1.getParentId()) {

                if (menu1.getChildren() == null) {
                    menu1.setChildren(new ArrayList&lt;Menu&gt;());
                }
                menu.getChildren().add(findChildMenu(menu1, menuList));
            }
        }
        return menu;
    } 
</code></pre></div><h2 id="_12-注解事务"><a href="#_12-注解事务" class="header-anchor">#</a> 12.注解事务</h2> <div class="language- extra-class"><pre class="language-text"><code>    添加注解 @Transactional 
    
    @Override
    @Transactional  //事务注解
    public R addArticle(AddArticleDto addArticleDto) {
        // 添加文章
        Article article = BeanCopyUtils.copyBean(addArticleDto, Article.class);
        save(article);

        // 获取标签列表
        List&lt;ArticleTag&gt; articleTags = addArticleDto.getTags().stream()
                .map(tagId -&gt; new ArticleTag(article.getId(), tagId))

                .collect(Collectors.toList());
        // 添加博客和标签到关联
        articleTagService.saveBatch(articleTags);
        return R.okResult();
    }
</code></pre></div><h2 id="_13-导出和导入功能"><a href="#_13-导出和导入功能" class="header-anchor">#</a> 13.导出和导入功能</h2> <p>更多信息</p> <p>https://easyexcel.opensource.alibaba.com/docs/current/quickstart/write#%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81-1</p> <h3 id="_1-依赖"><a href="#_1-依赖" class="header-anchor">#</a> 1.依赖</h3> <div class="language- extra-class"><pre class="language-text"><code>&lt;!-- https://mvnrepository.com/artifact/com.alibaba/easyexcel --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;com.alibaba&lt;/groupId&gt;
    &lt;artifactId&gt;easyexcel&lt;/artifactId&gt;
    &lt;version&gt;3.0.5&lt;/version&gt;
&lt;/dependency&gt;
</code></pre></div><h3 id="_2-一些工具"><a href="#_2-一些工具" class="header-anchor">#</a> 2.一些工具</h3> <div class="language- extra-class"><pre class="language-text"><code>WebUtils
设置响应头
    public static void setDownLoadHeader(String filename, HttpServletResponse response) throws UnsupportedEncodingException {
        response.setContentType(&quot;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&quot;);
        response.setCharacterEncoding(&quot;utf-8&quot;);
        String fname= URLEncoder.encode(filename,&quot;UTF-8&quot;).replaceAll(&quot;\\+&quot;, &quot;%20&quot;);
        response.setHeader(&quot;Content-disposition&quot;,&quot;attachment; filename=&quot;+fname);
    }
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>ExcelCategoryVo

@Data
@NoArgsConstructor
@AllArgsConstructor
public class ExcelCategoryVo {
    @ExcelProperty(&quot;分类名&quot;)
    private String name;
    //描述
    @ExcelProperty(&quot;描述&quot;)
    private String description;

    //状态0:正常,1禁用
    @ExcelProperty(&quot;状态0:正常,1禁用&quot;)
    private String status;
}
</code></pre></div><h3 id="_3-controller"><a href="#_3-controller" class="header-anchor">#</a> 3.Controller</h3> <div class="language- extra-class"><pre class="language-text"><code>    @GetMapping(&quot;/export&quot;)
    public void export(HttpServletResponse response) {
        try {
            //设置下载文件的请求头
            WebUtils.setDownLoadHeader(&quot;分类.xlsx&quot;, response);
            //获取需要导出的数据
            List&lt;Category&gt; list = categoryService.list();
            List&lt;ExcelCategoryVo&gt; vos = BeanCopyUtils.copyBeanList(list, ExcelCategoryVo.class);
            //把数据写入到Excel中
            EasyExcel.write(response.getOutputStream(), ExcelCategoryVo.class)
                    .autoCloseStream(Boolean.FALSE)
                    .sheet(&quot;分类导出&quot;)
                    .doWrite(vos);
        } catch (Exception e) {
            //如果出现异常也要响应json
            R result = R.errorResult(AppHttpCodeEnum.SYSTEM_ERROR);
            WebUtils.renderString(response, JSON.toJSONString(result));
        }
    }
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.dd397728.js" defer></script><script src="/assets/js/2.6430ac10.js" defer></script><script src="/assets/js/26.079d4c49.js" defer></script>
  </body>
</html>
